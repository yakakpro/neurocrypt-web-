<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üåå –†–µ–∑–æ–Ω–æ–º–µ—Ç—Ä ‚àû v4</title>
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#0e0e0e">
  <link rel="icon" href="https://via.placeholder.com/192x192.png?text=üåå" type="image/png">
  <style>
    body {
      font-family: 'Courier New', monospace;
      background: #0e0e0e;
      color: #00ffcc;
      padding: 2rem;
      position: relative;
      overflow-x: hidden;
    }
    #matrix {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      opacity: 0.35;
    }
    input, select, button, textarea {
      background: rgba(0,0,0,0.85);
      color: #00ffcc;
      border: 1px solid #00ffcc;
      padding: 0.5rem;
      margin: 0.5rem 0;
      width: 100%;
      box-shadow: 0 0 12px #00ffcc, inset 0 0 8px #ff00ff;
      transition: box-shadow 0.3s;
      animation: input-glitch 1s infinite;
    }
    input:focus, textarea:focus, select:focus {
      box-shadow: 0 0 25px #00ffcc, inset 0 0 15px #ff00ff;
      animation: none;
    }
    @keyframes input-glitch {
      0%, 100% { transform: translate(0); }
      50% { transform: translate(0.3px, -0.3px); }
    }
    button {
      cursor: pointer;
      position: relative;
      overflow: hidden;
      background: linear-gradient(90deg, #00ffcc, #ff00ff);
      color: #0e0e0e;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 1px;
      padding: 0.5rem;
      margin: 0.5rem 0;
      border: 1px solid #00ffcc;
      transition: box-shadow 0.3s;
    }
    button:hover {
      box-shadow: 0 0 30px #00ffcc, 0 0 40px #ff00ff;
      animation: button-glitch 1s infinite;
    }
    @keyframes button-glitch {
      0%, 100% { transform: translate(0); }
      50% { transform: translate(0.3px, -0.3px); }
    }
    .section {
      border: 1px solid #333;
      padding: 1rem;
      margin-bottom: 2rem;
      background: rgba(0,0,0,0.65);
      box-shadow: 0 0 15px #00ffcc;
    }
    canvas {
      max-width: 100%;
      margin-top: 1rem;
      border: 1px solid #00ffcc;
      background: #0e0e0e;
    }
    .glow { animation: glow 1.2s infinite; }
    @keyframes glow {
      0%, 100% { text-shadow: 0 0 8px #00ffcc, 0 0 15px #ff00ff; }
      50% { text-shadow: 0 0 30px #00ffcc, 0 0 50px #ff00ff; }
    }
    .quantum {
      font-size: 0.9rem;
      color: #ff00ff;
      letter-spacing: 2px;
      text-transform: uppercase;
    }
    #result {
      animation: typing 0.7s steps(30, end);
      white-space: pre-wrap;
      overflow: hidden;
      color: #00ffcc;
      text-shadow: 0 0 8px #00ffcc;
      font-size: 0.95rem;
      animation: result-glitch 1s infinite;
    }
    @keyframes typing {
      from { width: 0; }
      to { width: 100%; }
    }
    @keyframes result-glitch {
      0%, 100% { transform: translate(0); }
      50% { transform: translate(0.3px, -0.3px); }
    }
    h1, h2, h3 {
      text-transform: uppercase;
      letter-spacing: 5px;
      animation: header-glitch 1s infinite;
    }
    @keyframes header-glitch {
      0%, 100% { transform: translate(0); }
      50% { transform: translate(0.3px, -0.3px); }
    }
    ul { list-style: none; padding: 0; }
    li { margin: 5px 0; color: #00ffcc; }
    label { color: #00ffcc; }
    pre { white-space: pre-wrap; margin-top: 10px; color: #00ffcc; }
  </style>
</head>
<body>
  <h1 class="glow">üåå –†–µ–∑–æ–Ω–æ–º–µ—Ç—Ä ‚àû v4</h1>
  <div class="quantum">‚ö°Ô∏è –ê–Ω–∞–ª—ñ–∑ —Ä–µ–∑–æ–Ω–∞–Ω—Å—É –¥—É–º–æ–∫</div>

  <div class="section">
    <label>üß† –í–í–ï–î–ò –§–†–ê–ó–£:</label>
    <input id="phraseInput" placeholder="–°–õ–û–í–û, –§–†–ê–ó–ê –ê–ë–û –î–£–ú–ö–ê" />

    <label>üé® –Ø–ö–ò–ô –ö–û–õ–Ü–† –ü–ï–†–®–ò–ô –°–ü–ê–î–ê–Ñ –ù–ê –î–£–ú–ö–£?</label>
    <select id="colorSelect">
      <option value="—Ç–µ–ø–ª–∏–π">–¢–ï–ü–õ–ò–ô</option>
      <option value="—Ö–æ–ª–æ–¥–Ω–∏–π">–•–û–õ–û–î–ù–ò–ô</option>
      <option value="—Å—ñ—Ä–∏–π">–°–Ü–†–ò–ô</option>
      <option value="—è—Å–∫—Ä–∞–≤–∏–π">–Ø–°–ö–†–ê–í–ò–ô</option>
    </select>

    <label>üå´ –Ø–ö –í–û–ù–ê –í–Ü–î–ß–£–í–ê–Ñ–¢–¨–°–Ø?</label>
    <select id="feelSelect">
      <option value="–ª–µ–≥–∫—ñ—Å—Ç—å">–õ–ï–ì–ö–Ü–°–¢–¨</option>
      <option value="–Ω–∞–ø—Ä—É–≥–∞">–ù–ê–ü–†–£–ì–ê</option>
      <option value="–ø–æ—Ä–æ–∂–Ω–µ—á–∞">–ü–û–†–û–ñ–ù–ï–ß–ê</option>
      <option value="–≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π –¥–∑–≤—ñ–Ω">–í–ù–£–¢–†–Ü–®–ù–Ü–ô –î–ó–í–Ü–ù</option>
    </select>

    <label>‚ôªÔ∏è –•–û–ß–ï–® –á–á –ü–û–í–¢–û–†–ò–¢–ò?</label>
    <select id="repeatSelect">
      <option value="—Ç–∞–∫">–¢–ê–ö</option>
      <option value="–Ω—ñ">–ù–Ü</option>
      <option value="–Ω–µ –∑–Ω–∞—é">–ù–ï –ó–ù–ê–Æ</option>
    </select>

    <label>üò∂ –Ø–ö–ò–ô –ï–ú–û–¶–Ü–ô–ù–ò–ô –°–¢–ê–ù –í–ò–ö–õ–ò–ö–ê–Ñ –¶–Ø –§–†–ê–ó–ê?</label>
    <select id="emotionSelect">
      <option value="—Å–ø–æ–∫—ñ–π">–°–ü–û–ö–Ü–ô</option>
      <option value="—Ç—Ä–∏–≤–æ–≥–∞">–¢–†–ò–í–û–ì–ê</option>
      <option value="—Ä–∞–¥—ñ—Å—Ç—å">–†–ê–î–Ü–°–¢–¨</option>
      <option value="—Å–º—É—Ç–æ–∫">–°–ú–£–¢–û–ö</option>
    </select>

    <label>‚è≥ –ö–û–õ–ò –¶–Ø –î–£–ú–ö–ê –†–ï–ó–û–ù–£–Ñ –ù–ê–ô–ë–Ü–õ–¨–®–ï?</label>
    <select id="timeSelect">
      <option value="–º–∏–Ω—É–ª–µ">–ú–ò–ù–£–õ–ï</option>
      <option value="—Å—å–æ–≥–æ–¥–µ–Ω–Ω—è">–°–¨–û–ì–û–î–ï–ù–ù–Ø</option>
      <option value="–º–∞–π–±—É—Ç–Ω—î">–ú–ê–ô–ë–£–¢–ù–Ñ</option>
    </select>

    <label>‚ö° –Ø–ö–ê –ï–ù–ï–†–ì–Ü–Ø –¶–Ü–Ñ–á –î–£–ú–ö–ò?</label>
    <select id="energySelect">
      <option value="–¥–∞—î –µ–Ω–µ—Ä–≥—ñ—é">–î–ê–Ñ –ï–ù–ï–†–ì–Ü–Æ</option>
      <option value="–∑–∞–±–∏—Ä–∞—î –µ–Ω–µ—Ä–≥—ñ—é">–ó–ê–ë–ò–†–ê–Ñ –ï–ù–ï–†–ì–Ü–Æ</option>
      <option value="–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–∞">–ù–ï–ô–¢–†–ê–õ–¨–ù–ê</option>
    </select>

    <label>üå† –Ø–ö–ò–ô –°–ò–ú–í–û–õ –ê–ë–û –û–ë–†–ê–ó –°–ü–ê–î–ê–Ñ –ù–ê –î–£–ú–ö–£?</label>
    <input id="symbolInput" placeholder="–ù–ê–ü–†–ò–ö–õ–ê–î, –ó–Ü–†–ö–ê, –•–í–ò–õ–Ø, –î–ï–†–ï–í–û" />

    <button onclick="analyze()">üéØ –ê–ù–ê–õ–Ü–ó–£–í–ê–¢–ò –†–ï–ó–û–ù–ê–ù–°</button>

    <div id="result" style="margin-top: 15px;"></div>

    <h3>üìà –Ü–°–¢–û–†–Ü–Ø</h3>
    <ul id="history"></ul>

    <button onclick="exportVault()">üíæ –ï–ö–°–ü–û–†–¢ –£ VAULT</button>
    <button onclick="exportToNeuroShifrator()">üîê –ï–ö–°–ü–û–†–¢ –£ –ù–ï–ô–†–û–®–ò–§–†–ê–¢–û–†</button>
    <pre id="vaultOutput" style="white-space: pre-wrap; margin-top: 10px;"></pre>

    <canvas id="chart" width="400" height="200"></canvas>
  </div>

  <script>
    let historyData = [];

    // –ú–∞—Ç—Ä–∏—á–Ω–∏–π –¥–æ—â
    window.onload = () => {
      const canvas = document.createElement('canvas');
      canvas.id = 'matrix';
      document.body.appendChild(canvas);
      const ctx = canvas.getContext('2d');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ–∞–±–≤–≥“ë–¥–µ—î–∂–∑–∏—ñ—ó–π–∫–ª–º–Ω–æ–ø—Ä—Å—Ç—É—Ñ—Ö—Ü—á—à—â—å—é—èüß†üî•üíßüåï‚ö°Ô∏èüåÄ';
      const fontSize = 16;
      const columns = canvas.width / fontSize;
      const drops = Array(Math.floor(columns)).fill(1);

      function draw() {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = '#00ffcc';
        ctx.font = fontSize + 'px monospace';
        for (let i = 0; i < drops.length; i++) {
          const text = chars.charAt(Math.floor(Math.random() * chars.length));
          ctx.fillText(text, i * fontSize, drops[i] * fontSize);
          if (drops[i] * fontSize > canvas.height && Math.random() > 0.95) drops[i] = 0;
          drops[i]++;
        }
      }
      setInterval(draw, 35);

      // –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è Service Worker –¥–ª—è PWA
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw-resonometer.js')
          .then(registration => {
            console.log('Service Worker –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ –¥–ª—è –†–µ–∑–æ–Ω–æ–º–µ—Ç—Ä–∞:', registration);
          })
          .catch(error => {
            console.log('–ü–æ–º–∏–ª–∫–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó Service Worker:', error);
          });
      }
    };

    function analyze() {
      const phrase = document.getElementById('phraseInput').value;
      const color = document.getElementById('colorSelect').value;
      const feel = document.getElementById('feelSelect').value;
      const repeat = document.getElementById('repeatSelect').value;
      const emotion = document.getElementById('emotionSelect').value;
      const time = document.getElementById('timeSelect').value;
      const energy = document.getElementById('energySelect').value;
      const symbol = document.getElementById('symbolInput').value;

      let score = 0;
      if (color === "—Ç–µ–ø–ª–∏–π" || color === "—è—Å–∫—Ä–∞–≤–∏–π") score += 1;
      if (feel === "–≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π –¥–∑–≤—ñ–Ω") score += 1;
      if (repeat === "—Ç–∞–∫") score += 1;
      if (emotion === "—Ä–∞–¥—ñ—Å—Ç—å" || emotion === "—Å–ø–æ–∫—ñ–π") score += 1;
      if (time === "–º–∞–π–±—É—Ç–Ω—î" || time === "—Å—å–æ–≥–æ–¥–µ–Ω–Ω—è") score += 1;
      if (energy === "–¥–∞—î –µ–Ω–µ—Ä–≥—ñ—é") score += 1;
      if (symbol.trim() !== "") score += 1;

      let res = "üåë –í–Ü–î–°–£–¢–ù–Ü–°–¢–¨ –†–ï–ó–û–ù–ê–ù–°–£";
      if (score >= 1 && score <= 2) res = "üåí –°–õ–ê–ë–ö–ò–ô –†–ï–ó–û–ù–ê–ù–°";
      if (score >= 3 && score <= 4) res = "üåì –ü–û–ú–Ü–†–ù–ò–ô –†–ï–ó–û–ù–ê–ù–°";
      if (score >= 5 && score <= 6) res = "üåî –°–ò–õ–¨–ù–ò–ô –†–ï–ó–û–ù–ê–ù–°";
      if (score === 7) res = "üåï –ê–ë–°–û–õ–Æ–¢–ù–ò–ô –†–ï–ó–û–ù–ê–ù–°";

      const now = new Date().toLocaleTimeString();
      const record = { phrase, color, feel, repeat, emotion, time, energy, symbol, score, res, time: now };
      historyData.push(record);

      document.getElementById('result').innerHTML = `<b>${res}</b><br><i>${phrase}</i> (${now})<br>–ë–ê–õ: ${score}/7`;

      updateHistory();
      drawChart();
    }

    function updateHistory() {
      const list = document.getElementById('history');
      list.innerHTML = "";
      historyData.slice(-10).reverse().forEach(r => {
        const li = document.createElement('li');
        li.textContent = `[${r.time}] ${r.phrase} ‚Äî ${r.res} (–ë–ê–õ: ${r.score}/7)`;
        list.appendChild(li);
      });
    }

    function drawChart() {
      const canvas = document.getElementById("chart");
      const ctx = canvas.getContext("2d");
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.beginPath();
      ctx.strokeStyle = "#00ffcc";
      ctx.lineWidth = 2;

      let step = canvas.width / Math.max(1, historyData.length - 1);
      historyData.forEach((r, i) => {
        const x = i * step;
        const y = canvas.height - (r.score / 7) * canvas.height;
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      });
      ctx.stroke();
    }

    function exportVault() {
      const vault = {
        type: "resonometer",
        entries: historyData
      };
      const output = JSON.stringify(vault, null, 2);
      document.getElementById("vaultOutput").textContent = output;
    }

    function exportToNeuroShifrator() {
      const vault = {
        type: "resonometer",
        entries: historyData
      };
      const output = JSON.stringify(vault, null, 2);
      localStorage.setItem("resonometerVault", output);
      window.location.href = "index.html";
    }
  </script>
</body>
</html>
