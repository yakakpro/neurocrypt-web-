<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>–†–µ–∑–æ–Ω–æ–º–µ—Ç—Ä ‚àû</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: #0e0e0e;
      color: #e0e0e0;
      padding: 20px;
    }
    input, select, button, textarea {
      background: #1a1a1a;
      color: #e0e0e0;
      border: 1px solid #444;
      padding: 8px;
      margin: 5px 0;
      width: 100%;
    }
    canvas { background: #fff; margin-top: 20px; }
  </style>
</head>
<body>
  <h2>üåå –†–µ–∑–æ–Ω–æ–º–µ—Ç—Ä v2</h2>
  <label>üß† –í–≤–µ–¥–∏ —Ñ—Ä–∞–∑—É:</label>
  <input id="phraseInput" placeholder="—Å–ª–æ–≤–æ, —Ñ—Ä–∞–∑–∞ –∞–±–æ –¥—É–º–∫–∞" />

  <label>üé® –Ø–∫–∏–π –∫–æ–ª—ñ—Ä –ø–µ—Ä—à–∏–π —Å–ø–∞–¥–∞—î –Ω–∞ –¥—É–º–∫—É?</label>
  <select id="colorSelect">
    <option value="—Ç–µ–ø–ª–∏–π">–¢–µ–ø–ª–∏–π</option>
    <option value="—Ö–æ–ª–æ–¥–Ω–∏–π">–•–æ–ª–æ–¥–Ω–∏–π</option>
    <option value="—Å—ñ—Ä–∏–π">–°—ñ—Ä–∏–π</option>
    <option value="—è—Å–∫—Ä–∞–≤–∏–π">–Ø—Å–∫—Ä–∞–≤–∏–π</option>
  </select>

  <label>üå´ –Ø–∫ –≤–æ–Ω–∞ –≤—ñ–¥—á—É–≤–∞—î—Ç—å—Å—è?</label>
  <select id="feelSelect">
    <option value="–ª–µ–≥–∫—ñ—Å—Ç—å">–õ–µ–≥–∫—ñ—Å—Ç—å</option>
    <option value="–Ω–∞–ø—Ä—É–≥–∞">–ù–∞–ø—Ä—É–≥–∞</option>
    <option value="–ø–æ—Ä–æ–∂–Ω–µ—á–∞">–ü–æ—Ä–æ–∂–Ω–µ—á–∞</option>
    <option value="–≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π –¥–∑–≤—ñ–Ω">–í–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π –¥–∑–≤—ñ–Ω</option>
  </select>

  <label>‚ôªÔ∏è –•–æ—á–µ—à —ó—ó –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏?</label>
  <select id="repeatSelect">
    <option value="—Ç–∞–∫">–¢–∞–∫</option>
    <option value="–Ω—ñ">–ù—ñ</option>
    <option value="–Ω–µ –∑–Ω–∞—é">–ù–µ –∑–Ω–∞—é</option>
  </select>

  <button onclick="analyze()">üéØ –ê–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Ä–µ–∑–æ–Ω–∞–Ω—Å</button>

  <div id="result" style="margin-top: 15px;"></div>

  <h3>üìà –Ü—Å—Ç–æ—Ä—ñ—è</h3>
  <ul id="history"></ul>

  <button onclick="exportVault()">üíæ Export to Vault</button>
  <pre id="vaultOutput" style="white-space: pre-wrap; margin-top: 10px;"></pre>

  <canvas id="chart" width="400" height="200"></canvas>

  <script>
    let historyData = [];

    function analyze() {
      const phrase = document.getElementById('phraseInput').value;
      const color = document.getElementById('colorSelect').value;
      const feel = document.getElementById('feelSelect').value;
      const repeat = document.getElementById('repeatSelect').value;

      let score = 0;
      if (color === "—Ç–µ–ø–ª–∏–π" || color === "—è—Å–∫—Ä–∞–≤–∏–π") score += 1;
      if (feel === "–≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π –¥–∑–≤—ñ–Ω") score += 1;
      if (repeat === "—Ç–∞–∫") score += 1;

      let res = "üåë –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å —Ä–µ–∑–æ–Ω–∞–Ω—Å—É";
      if (score === 1) res = "üåó –ß–∞—Å—Ç–∫–æ–≤–∏–π —Ä–µ–∑–æ–Ω–∞–Ω—Å";
      if (score >= 2) res = "üåï –ü–æ–≤–Ω–∏–π —Ä–µ–∑–æ–Ω–∞–Ω—Å";

      const now = new Date().toLocaleTimeString();
      const record = { phrase, color, feel, repeat, score, res, time: now };
      historyData.push(record);

      document.getElementById('result').innerHTML = `<b>${res}</b><br><i>${phrase}</i> (${now})`;

      updateHistory();
      drawChart();
    }

    function updateHistory() {
      const list = document.getElementById('history');
      list.innerHTML = "";
      historyData.slice(-10).reverse().forEach(r => {
        const li = document.createElement('li');
        li.textContent = `[${r.time}] ${r.phrase} ‚Äî ${r.res}`;
        list.appendChild(li);
      });
    }

    function drawChart() {
      const canvas = document.getElementById("chart");
      const ctx = canvas.getContext("2d");
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.beginPath();
      ctx.strokeStyle = "#00ffff";
      ctx.lineWidth = 2;

      let step = canvas.width / Math.max(1, historyData.length - 1);
      historyData.forEach((r, i) => {
        const x = i * step;
        const y = canvas.height - (r.score / 3) * canvas.height;
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      });
      ctx.stroke();
    }

    function exportVault() {
      const vault = {
        type: "resonometer",
        entries: historyData
      };
      const output = JSON.stringify(vault, null, 2);
      document.getElementById("vaultOutput").textContent = output;
    }
  </script>
</body>
</html>
